<!doctype html>
<html lang="th">

<head>
    <meta charset="utf-8">
    <title>PAID</title>
    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-light">
    <div class="container py-4">
        <h1 class="mb-3">ข้อมูล</h1>
        <a href="{{ url_for('import_excel') }}" class="btn btn-success mb-3">นำเข้า Excel</a>
        <a href="{{ url_for('import_paid') }}" class="btn btn-primary mb-3">นำเข้า Paid</a>

        <!-- แถบควบคุมจำนวนต่อหน้า -->
        <form class="row g-2 mb-3" method="get">
            <div class="col-auto">
                <label class="col-form-label">แสดงต่อหน้า</label>
            </div>
            <div class="col-auto">
                <select name="per_page" class="form-select" onchange="this.form.submit()">
                    {% for n in [10,20,50,100] %}
                    <option value="{{ n }}" {{ 'selected' if per_page==n else '' }}>{{ n }}</option>
                    {% endfor %}
                </select>
            </div>
            <!-- คง page=1 เสมอเมื่อเปลี่ยน per_page -->
            <input type="hidden" name="page" value="1">
        </form>

        <div class="card shadow-sm">
            <div class="table-responsive">
                <table class="table table-striped table-hover mb-0 align-middle">
                    <thead class="table-dark">
                        <tr>
                            <th>day</th>
                            <th>claim</th>
                            <th>invoice</th>
                            <th>invoiceref</th>
                            <th>no</th>
                            <th>offer</th>
                            <th>approve</th>
                            <th>status</th>
                            <th>statuskey</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for r in rows %}
                        <tr>
                            <td>{{ r.day }}</td>
                            <td>{{ r.claim }}</td>
                            <td>{{ r.invoice }}</td>
                            <td>{{ r.invoiceref }}</td>
                            <td>{{ r.no }}</td>
                            <td>{{ r.offer }}</td>
                            <td>{{ r.approve }}</td>
                            <td>{{ r.status }}</td>
                            <td>{{ r.statuskey }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>

        <!-- ข้อความสรุป + ปุ่มเลขหน้า -->
        <div class="d-flex flex-column flex-md-row justify-content-between align-items-md-center mt-3 gap-2">
            <div class="text-muted small">
                {{ pagination.info }} <!-- ใช้ display_msg จาก Pagination -->
            </div>
            <nav aria-label="Page navigation">
                {{ pagination.links }}
            </nav>
        </div>
    </div>
</body>